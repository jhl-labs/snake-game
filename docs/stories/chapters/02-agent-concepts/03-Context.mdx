import { Meta, Source } from '@storybook/blocks';
import { Placeholder } from '../../../components/Placeholder';
import { ChapterNav } from '../../../components/ChapterNav';
import { Mermaid } from '../../../components/Mermaid';

<Meta title="Chapters/02. Agent 기본 개념/2.3 컨텍스트의 중요성" />

# 2.3 컨텍스트의 중요성

Agent의 성능은 **컨텍스트(Context)**에 크게 의존합니다.
좋은 컨텍스트를 제공할수록 정확하고 일관된 결과를 얻을 수 있습니다.

---

## 컨텍스트의 종류

<Mermaid chart={`
flowchart TB
    subgraph Context["Agent 컨텍스트"]
        Project["📁 프로젝트 컨텍스트<br/>디렉토리 구조, 설정 파일"]
        Code["📄 코드 컨텍스트<br/>열린 파일, 선택 영역"]
        Rules["📋 규칙 컨텍스트<br/>코딩 스타일, 아키텍처"]
        Chat["💬 대화 컨텍스트<br/>이전 대화, 누적 정보"]
    end

    Project --> Agent["🤖 Agent"]
    Code --> Agent
    Rules --> Agent
    Chat --> Agent
    Agent --> Response["정확한 응답"]
`} />

### 1. 프로젝트 컨텍스트

Agent가 **자동으로 수집**하는 정보:

- 디렉토리 구조
- 파일 목록
- 설정 파일 (Makefile, package.json 등)

<Source
  language="text"
  code={`
snake-game/
├── src/           ← Agent가 "소스 폴더" 인식
├── include/       ← "헤더 폴더" 인식
├── .cursor/       ← "Cursor 설정" 인식
└── Makefile       ← "빌드 시스템" 인식
`}
/>

### 2. 코드 컨텍스트

현재 **작업 중인 파일** 관련 정보:

- 열려 있는 파일
- 선택된 코드 영역
- 관련 파일 (import, include)

### 3. 규칙 컨텍스트

**Rule 파일**에서 정의한 지침:

- 코딩 스타일
- 아키텍처 규칙
- 금지 사항

### 4. 대화 컨텍스트

이전 대화에서 **누적된 정보**:

- 이전 질문/답변
- 수행한 작업
- 확인된 사실

---

## 컨텍스트가 결과에 미치는 영향

### 예시: 같은 요청, 다른 결과

**컨텍스트 없이:**

<Source
  language="text"
  code={`
> 함수를 만들어줘

Agent: "어떤 함수를 만들까요? 더 구체적으로 알려주세요."
`}
/>

**컨텍스트와 함께:**

<Source
  language="text"
  code={`
# snake.c 파일이 열려 있고, snake_move 함수 아래에 커서가 있을 때

> 함수를 만들어줘

Agent: "snake_move와 관련된 함수를 만드시겠어요?
       snake_can_move() 같은 검증 함수는 어떨까요?"
`}
/>

---

## Cursor에서 컨텍스트 제공하기

### @ 멘션 시스템

Cursor는 `@` 멘션으로 **명시적으로 컨텍스트를 지정**할 수 있습니다:

| 멘션 | 설명 |
|------|------|
| `@파일명` | 특정 파일을 컨텍스트에 추가 |
| `@폴더명` | 폴더 전체를 컨텍스트에 추가 |
| `@Codebase` | 전체 코드베이스에서 관련 코드 검색 |
| `@Web` | 웹 검색 결과 포함 |
| `@Docs` | 문서 검색 (라이브러리 문서 등) |

<Source
  language="text"
  code={`
# 특정 파일 참조
@snake.c 이 파일의 snake_grow 함수를 설명해줘

# 여러 파일 참조
@snake.c @snake.h 이 파일들에서 뱀의 방향 전환은 어떻게 구현되어 있어?

# 코드베이스 전체 검색
@Codebase 충돌 감지 로직이 어디에 구현되어 있어?

# 웹 검색 포함
@Web raylib에서 키보드 입력 처리하는 방법을 알려줘
`}
/>

### 파일 읽기 전략

Cursor는 파일 크기에 따라 **자동으로 읽기 전략을 선택**합니다:

- 짧은 파일: 전체 내용 포함
- 긴 파일: 관련 부분만 선택적으로 포함 (chunking + reranking)

### 새 채팅 시작 (Cmd + N)

새로운 작업을 시작할 때 깨끗한 컨텍스트로 시작:

<Source
  language="text"
  code={`
# Cmd + N으로 새 채팅 시작
# 이전 대화의 컨텍스트가 초기화됨
`}
/>

---

## Claude Code에서 컨텍스트 제공하기

### 파일 직접 언급

Claude Code는 파일명을 언급하면 **자동으로 탐색**합니다:

<Source
  language="text"
  code={`
> snake.c 파일의 snake_grow 함수를 수정해줘
# Claude Code가 자동으로 파일을 찾아서 읽음

> src 폴더에 있는 모든 .c 파일을 분석해줘
# 폴더 단위로 요청 가능
`}
/>

### 관련 정보 먼저 읽기

<Source
  language="text"
  code={`
# 먼저 컨텍스트 제공
> game.h 파일을 읽어줘
> game.c의 게임 루프를 읽어줘

# 그 다음 요청 (이전 대화 참조)
> 새로운 게임 상태를 추가해줘
`}
/>

### /compact 명령어

대화가 길어지면 **컨텍스트를 압축**하여 토큰을 절약합니다:

<Source
  language="bash"
  code={`
> /compact
# 이전 대화를 요약하여 컨텍스트 축소
# 핵심 정보는 유지하면서 길이 감소
`}
/>

### /clear 명령어

새로운 작업을 시작할 때 **컨텍스트 초기화**:

<Source
  language="bash"
  code={`
> /clear
# 대화 히스토리 완전 초기화
`}
/>

---

## Cursor vs Claude Code 컨텍스트 비교

| 기능 | Cursor | Claude Code |
|------|--------|-------------|
| 파일 참조 | `@파일명` 멘션 | 파일명 직접 언급 |
| 폴더 참조 | `@폴더명` 멘션 | "폴더에 있는 파일들" 언급 |
| 코드베이스 검색 | `@Codebase` | 자동 탐색 |
| 웹 검색 | `@Web` | 기본 지원 |
| 문서 검색 | `@Docs` | 웹 검색으로 대체 |
| 컨텍스트 압축 | 새 채팅 (`Cmd+N`) | `/compact` |
| 컨텍스트 초기화 | 새 채팅 (`Cmd+N`) | `/clear` |
| 파일 읽기 전략 | 자동 | 자동 |

---

## 실습 2-2: 멀티턴 대화

연속적인 대화로 컨텍스트를 쌓아가며 복잡한 작업을 수행해보세요.

### Cursor에서

<Source
  language="text"
  code={`
# 1단계: 파일 참조
@game.c game_update 함수가 하는 일을 설명해줘

# 2단계: 상세 분석 (이전 컨텍스트 유지)
이 함수에서 충돌 감지는 어떻게 처리되고 있어?

# 3단계: 수정 요청
벽 충돌 감지 로직을 개선해줘
`}
/>

### Claude Code에서

<Source
  language="text"
  code={`
# 1단계: 파일 읽기
> game.c 파일을 읽어줘

# 2단계: 함수 이해
> game_update 함수가 하는 일을 설명해줘

# 3단계: 상세 분석
> 이 함수에서 충돌 감지는 어떻게 처리되고 있어?

# 4단계: 수정 요청
> 벽 충돌 감지 로직을 개선해줘
`}
/>

---

## 핵심 정리

<div style={{
  backgroundColor: '#f0f9ff',
  padding: '1rem',
  borderRadius: '8px',
  marginTop: '1.5rem'
}}>

1. 컨텍스트는 **프로젝트, 코드, 규칙, 대화** 4가지 종류
2. **Cursor**: `@` 멘션으로 명시적 컨텍스트 지정
3. **Claude Code**: 파일명 언급으로 자동 탐색, `/compact`로 압축
4. 멀티턴 대화로 **컨텍스트를 누적**하여 복잡한 작업 수행

</div>

<ChapterNav
  prevLink="?path=/docs/chapters-02-agent-기본-개념-2-2-agent-도구--docs"
  prevTitle="2.2 Agent 도구"
  nextLink="?path=/docs/chapters-03-rule-파일-작성-3-1-cursor-rule-파일--docs"
  nextTitle="3.1 Cursor Rule 파일"
/>
