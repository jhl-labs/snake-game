import { Meta, Source } from '@storybook/blocks';
import { Placeholder } from '../../../components/Placeholder';
import { ExerciseCard } from '../../../components/ExerciseCard';
import { ChapterNav } from '../../../components/ChapterNav';

<Meta title="Chapters/05. CLAUDE.md 및 agent.md/5.2 agent.md 작성" />

# 5.2 agent.md 작성

`agent.md`는 **Agent의 행동 지침**을 정의합니다.
CLAUDE.md가 프로젝트 정보라면, agent.md는 작업 방식을 정의합니다.

---

## CLAUDE.md vs agent.md

| 파일 | 내용 | 예시 |
|------|------|------|
| **CLAUDE.md** | 프로젝트 정보 | 빌드 명령어, 아키텍처 |
| **agent.md** | 행동 지침 | 작업 방식, 금지사항 |

---

## agent.md 구조

<Source
  language="markdown"
  code={`
# Agent Instructions

## 작업 방식
1. 코드 수정 전 반드시 관련 파일 읽기
2. 변경 사항은 최소화
3. 기존 코드 스타일 유지

## 금지 사항
- 불필요한 리팩토링 금지
- 주석 없이 복잡한 로직 추가 금지
- 테스트 없이 기능 추가 금지

## 선호 사항
- 간결하고 명확한 코드
- 의미 있는 변수명
- 작은 단위의 변경

## 커밋 규칙
- 한 커밋에 하나의 변경만
- 커밋 메시지는 한글로 작성
- "왜" 변경했는지 설명
`}
/>


---

## 섹션별 설명

### 작업 방식

Agent가 **어떻게 작업해야 하는지** 정의:

<Source
  language="markdown"
  code={`
## 작업 방식

### 코드 수정 전
1. 관련 파일 모두 읽기
2. 의존성 파악
3. 영향 범위 확인

### 수정 시
1. 최소한의 변경으로 목표 달성
2. 기존 패턴 유지
3. 새로운 의존성 추가 자제

### 수정 후
1. 빌드 성공 확인
2. 관련 테스트 실행
3. 변경 사항 설명
`}
/>

### 금지 사항

Agent가 **하지 말아야 할 것**:

<Source
  language="markdown"
  code={`
## 금지 사항

### 절대 금지
- ❌ 요청하지 않은 리팩토링
- ❌ 파일 삭제 (명시적 요청 없이)
- ❌ 전역 변수 추가
- ❌ 외부 라이브러리 추가

### 주의 사항
- ⚠️ 대규모 변경 전 확인 요청
- ⚠️ 성능에 영향 주는 변경 시 경고
- ⚠️ 보안 관련 코드 변경 시 주의
`}
/>

### 선호 사항

Agent가 **따라야 할 원칙**:

<Source
  language="markdown"
  code={`
## 선호 사항

### 코드 스타일
- 간결하고 읽기 쉬운 코드
- 자기 문서화 코드 (의미 있는 이름)
- 적절한 주석 (왜 필요한지)

### 변경 방식
- 작은 단위로 점진적 변경
- 하나의 커밋에 하나의 목적
- 변경 전후 동작 확인

### 소통 방식
- 변경 이유 설명
- 대안이 있으면 제시
- 불확실하면 확인 요청
`}
/>

---

## 실습 5-1: CLAUDE.md 생성/수정

<ExerciseCard
  number={1}
  title="CLAUDE.md 자동 생성"
  difficulty="초급"
  description="Claude Code의 /init 명령으로 CLAUDE.md를 생성합니다."
/>

<Source
  language="bash"
  code={`
claude
> /init
`}
/>

<ExerciseCard
  number={2}
  title="CLAUDE.md 커스터마이징"
  difficulty="중급"
  description="raylib 사용 규칙과 테스트 가이드를 추가합니다."
/>

<Source
  language="text"
  code={`
> CLAUDE.md에 다음 내용을 추가해줘:
> 1. raylib은 renderer.c와 main.c에서만 사용
> 2. 테스트는 AAA 패턴으로 작성
> 3. 메모리 할당 후 반드시 해제
`}
/>


---

## 실습 5-2: agent.md 작성

<ExerciseCard
  number={3}
  title="agent.md 생성"
  difficulty="중급"
  description="프로젝트에 맞는 Agent 행동 지침을 작성합니다."
/>

<Source
  language="text"
  code={`
> 이 프로젝트에 맞는 agent.md를 작성해줘.

다음을 포함해야 해:
1. 코드 수정 전 확인 사항
2. MVC 패턴을 위반하지 않는 규칙
3. 커밋 메시지 규칙
`}
/>

---

## 핵심 정리

<div style={{
  backgroundColor: '#fef3c7',
  padding: '1rem',
  borderRadius: '8px',
  marginTop: '1.5rem'
}}>

1. **CLAUDE.md**: 프로젝트 정보 (무엇)
2. **agent.md**: 행동 지침 (어떻게)
3. **금지 사항**을 명시하면 실수 방지
4. **선호 사항**으로 일관된 품질 유지

</div>

<ChapterNav
  prevLink="?path=/docs/chapters-05-claude-md-및-agent-md-5-1-claude-md-구조--docs"
  prevTitle="5.1 CLAUDE.md 구조"
  nextLink="?path=/docs/chapters-06-subagent와-agent-skills-6-1-subagent-개념--docs"
  nextTitle="6.1 Subagent 개념"
/>
